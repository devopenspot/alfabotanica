---
import { translations } from '../translations';
---

<header class="sticky top-0 z-50 bg-med-cream/90 backdrop-blur-md border-b border-med-clay">
    <nav class="container mx-auto px-4 sm:px-6 py-4">
        <div class="flex justify-between items-center">
            <div class="text-xl sm:text-2xl font-bold tracking-widest text-med-sage uppercase">alfabotánica</div>

            {/* Desktop Navigation */}
            <ul class="hidden lg:flex space-x-8 text-sm uppercase tracking-widest">
                <li><a href="#shop" class="hover:text-med-terracotta transition" data-lang-target="shop">{translations.es.shop}</a></li>
                <li><a href="#philosophy" class="hover:text-med-terracotta transition" data-lang-target="roots">{translations.es.roots}</a></li>
                <li><a href="#contact" class="hover:text-med-terracotta transition" data-lang-target="contact">{translations.es.contact}</a></li>
            </ul>

            <div class="flex items-center space-x-3 sm:space-x-5">
                {/* Cart Button - Hidden on very small screens */}
                <button class="relative hidden sm:block">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                    </svg>
                    <span class="absolute -top-1 -right-1 bg-med-terracotta text-white text-[10px] rounded-full h-4 w-4 flex items-center justify-center">0</span>
                </button>

                {/* Mobile Menu Button */}
                <button class="lg:hidden p-2" id="mobile-menu-toggle" aria-label="Toggle mobile menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>

        {/* Mobile Navigation Menu */}
        <div id="mobile-menu" class="lg:hidden hidden mt-4 pb-4 border-t border-med-clay pt-4">
            <ul class="flex flex-col space-y-4 text-sm uppercase tracking-widest">
                <li><a href="#shop" class="block py-2 hover:text-med-terracotta transition" data-lang-target="shop">{translations.es.shop}</a></li>
                <li><a href="#philosophy" class="block py-2 hover:text-med-terracotta transition" data-lang-target="roots">{translations.es.roots}</a></li>
                <li><a href="#contact" class="block py-2 hover:text-med-terracotta transition" data-lang-target="contact">{translations.es.contact}</a></li>
            </ul>

            {/* Language Switcher in Mobile Menu */}
            <div class="mt-4 pt-4 border-t border-med-clay">
                <div class="space-y-3">
                    <span class="text-sm uppercase tracking-widest text-stone-600 font-medium">Language</span>
                    <div class="grid grid-cols-5 gap-2">
                        <button class="language-btn px-3 py-2 rounded-lg transition-all duration-200 text-stone-600 hover:bg-med-sage hover:text-white text-sm font-medium" data-lang="es">ES</button>
                        <button class="language-btn px-3 py-2 rounded-lg transition-all duration-200 text-stone-600 hover:bg-med-sage hover:text-white text-sm font-medium" data-lang="en">EN</button>
                        <button class="language-btn px-3 py-2 rounded-lg transition-all duration-200 text-stone-600 hover:bg-med-sage hover:text-white text-sm font-medium" data-lang="fr">FR</button>
                        <button class="language-btn px-3 py-2 rounded-lg transition-all duration-200 text-stone-600 hover:bg-med-sage hover:text-white text-sm font-medium" data-lang="it">IT</button>
                        <button class="language-btn px-2 py-2 rounded-lg transition-all duration-200 text-stone-600 hover:bg-med-sage hover:text-white text-xs font-medium" data-lang="zh">中文</button>
                    </div>
                </div>
            </div>

            {/* Mobile Cart Button */}
            <div class="mt-4 pt-4 border-t border-med-clay">
                <button class="flex items-center space-x-2 text-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                    </svg>
                    <span>Cart (0)</span>
                </button>
            </div>
        </div>
    </nav>

    <script>
        // Mobile menu toggle functionality
        document.addEventListener('DOMContentLoaded', () => {
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');

            if (mobileMenuToggle && mobileMenu) {
                mobileMenuToggle.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                    // Update aria-expanded for accessibility
                    const isExpanded = !mobileMenu.classList.contains('hidden');
                    mobileMenuToggle.setAttribute('aria-expanded', isExpanded);
                });

                // Close mobile menu when clicking outside or on a link
                document.addEventListener('click', (e) => {
                    if (!mobileMenuToggle.contains(e.target) && !mobileMenu.contains(e.target)) {
                        mobileMenu.classList.add('hidden');
                        mobileMenuToggle.setAttribute('aria-expanded', 'false');
                    }
                });

                // Close mobile menu when clicking on a navigation link
                mobileMenu.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', () => {
                        mobileMenu.classList.add('hidden');
                        mobileMenuToggle.setAttribute('aria-expanded', 'false');
                    });
                });

                // Handle language buttons in mobile menu
                mobileMenu.querySelectorAll('.language-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        const lang = e.target.dataset.lang;
                        // Trigger the same language switching logic as desktop
                        const event = new CustomEvent('languageChange', { detail: { lang } });
                        document.dispatchEvent(event);
                        // Close mobile menu after language selection
                        mobileMenu.classList.add('hidden');
                        mobileMenuToggle.setAttribute('aria-expanded', 'false');
                    });
                });
            }
        });
    </script>
</header>